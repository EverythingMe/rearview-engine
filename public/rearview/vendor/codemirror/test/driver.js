function Failure(e){this.message=e}function indexOf(e,n){if(e.indexOf)return e.indexOf(n);for(var t=0,i=e.length;i>t;++t)if(e[t]==n)return t;return-1}function test(e,n,t){for(var i=e,l=2;-1!==indexOf(allNames,e);)e=i+"_"+l,l++;return allNames.push(e),tests.push({name:e,func:n,expectedFail:t}),e}function testCM(e,n,t,i){return test("core_"+e,function(){var e=document.getElementById("testground"),i=CodeMirror(e,t),l=!1;try{n(i),l=!0}finally{debug&&!l||verbose?e.style.visibility="":e.removeChild(i.getWrapperElement())}},i)}function runTests(e){function n(i){if(i===tests.length)return running=!1,e("done");var l=tests[i],r=l.expectedFail,u=+new Date;if(null!==debug){var a=indexOf(debug,l.name);if(-1!==a)debug.splice(a,1);else{var s=l.name.split("_").shift()+"_*";if(a=indexOf(debug,s),-1!==a)debug.splice(a,1),debugUsed.push(s);else{if(a=indexOf(debugUsed,s),-1===a)return n(i+1);totalTests++}}}try{var f=l.func();r?e("fail",l.name,f):e("ok",l.name,f)}catch(o){if(r)e("expected",l.name);else if(o instanceof Failure)e("fail",l.name,o.message);else{var d=/\bat .*?([^\/:]+):(\d+):/.exec(o.stack);e("error",l.name,o.toString()+(d?" ("+d[1]+":"+d[2]+")":""))}}if(quit)return running=!1,null;var c=0;t+=+new Date-u,t>500&&(t=0,c=50),setTimeout(function(){n(i+1)},c)}debug&&(0===indexOf(debug,"verbose")&&(verbose=!0,debug.splice(0,1)),debug.length<1?debug=null:totalTests>debug.length&&(totalTests=debug.length));var t=0;n(0)}function label(e,n){return n?e+" ("+n+")":e}function eq(e,n,t){if(e!=n)throw new Failure(label(e+" != "+n,t))}function eqPos(e,n,t){function i(e){return"{line:"+e.line+",ch:"+e.ch+"}"}if(e!=n){if(null==e)throw new Failure(label("comparing null to "+i(n)));if(null==n)throw new Failure(label("comparing "+i(e)+" to null"));if(e.line!=n.line||e.ch!=n.ch)throw new Failure(label(i(e)+" != "+i(n),t))}}function is(e,n){if(!e)throw new Failure(label("assertion failed",n))}var tests=[],debug=null,debugUsed=new Array,allNames=[];