/*
 Data plugin for Highcharts v0.1

 (c) 2012 Torstein HÃ¸nsi

 License: www.highcharts.com/license
*/

!function(t){var e=t.each,i=function(t){this.init(t)};t.extend(i.prototype,{init:function(t){this.options=t,this.columns=[],this.parseCSV(),this.parseTable(),this.parseTypes(),this.findHeaderRow(),this.parsed(),this.complete()},parseCSV:function(){var t=this.options,i=t.csv,s=this.columns,n=t.startRow||0,o=t.endRow||Number.MAX_VALUE,a=t.startColumn||0,r=t.endColumn||Number.MAX_VALUE;i&&(i=i.split(t.lineDelimiter||"\n"),e(i,function(i,h){if(h>=n&&o>=h){var m=i.split(t.itemDelimiter||",");e(m,function(t,e){e>=a&&r>=e&&(s[e-a]||(s[e-a]=[]),s[e-a][h-n]=t)})}}))},parseTable:function(){var t,i=this.options,s=i.table,n=this.columns,o=i.startRow||0,a=i.endRow||Number.MAX_VALUE,r=i.startColumn||0,h=i.endColumn||Number.MAX_VALUE;s&&("string"==typeof s&&(s=document.getElementById(s)),e(s.getElementsByTagName("tr"),function(i,s){t=0,s>=o&&a>=s&&e(i.childNodes,function(e){("TD"===e.tagName||"TH"===e.tagName)&&t>=r&&h>=t&&(n[t]||(n[t]=[]),n[t][s-o]=e.innerHTML,t+=1)})}))},findHeaderRow:function(){e(this.columns,function(){}),this.headerRow=0},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},parseTypes:function(){for(var t,e,i,s,n=this.columns,o=n.length;o--;)for(t=n[o].length;t--;)e=n[o][t],i=parseFloat(e),s=this.trim(e),s==i?(n[o][t]=i,i>31536e6?n[o].isDatetime=!0:n[o].isNumeric=!0):(e=Date.parse(e),0!==o||"number"!=typeof e||isNaN(e)?n[o][t]=s:(n[o][t]=e,n[o].isDatetime=!0))},parsed:function(){this.options.parsed&&this.options.parsed.call(this,this.columns)},complete:function(){var t,e,i,s,n,o,a,r,h,m=this.columns,u=this.options;if(u.complete){for(m.length>1&&(i=m.shift(),0===this.headerRow&&i.shift(),(t=i.isNumeric||i.isDatetime)||(e=i),i.isDatetime&&(s="datetime")),n=[],r=0;r<m.length;r++){for(0===this.headerRow&&(a=m[r].shift()),o=[],h=0;h<m[r].length;h++)o[h]=void 0!==m[r][h]?t?[i[h],m[r][h]]:m[r][h]:null;n[r]={name:a,data:o}}u.complete({xAxis:{categories:e,type:s},series:n})}}}),t.Data=i,t.data=function(t){return new i(t)}}(Highcharts);