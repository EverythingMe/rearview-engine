/**
 * @license Data plugin for Highcharts v0.1
 *
 * (c) 2012 Torstein HÃ¸nsi
 *
 * License: www.highcharts.com/license
 */

!function(t){var e=t.each,i=function(t){this.init(t)};t.extend(i.prototype,{init:function(t){this.options=t,this.columns=[],this.parseCSV(),this.parseTable(),this.parseTypes(),this.findHeaderRow(),this.parsed(),this.complete()},parseCSV:function(){var t,i=this.options,s=i.csv,n=this.columns,o=i.startRow||0,a=i.endRow||Number.MAX_VALUE,r=i.startColumn||0,h=i.endColumn||Number.MAX_VALUE;s&&(t=s.split(i.lineDelimiter||"\n"),e(t,function(t,s){if(s>=o&&a>=s){var l=t.split(i.itemDelimiter||",");e(l,function(t,e){e>=r&&h>=e&&(n[e-r]||(n[e-r]=[]),n[e-r][s-o]=t)})}}))},parseTable:function(){var t,i=this.options,s=i.table,n=this.columns,o=i.startRow||0,a=i.endRow||Number.MAX_VALUE,r=i.startColumn||0,h=i.endColumn||Number.MAX_VALUE;s&&("string"==typeof s&&(s=document.getElementById(s)),e(s.getElementsByTagName("tr"),function(i,s){t=0,s>=o&&a>=s&&e(i.childNodes,function(e){("TD"===e.tagName||"TH"===e.tagName)&&t>=r&&h>=t&&(n[t]||(n[t]=[]),n[t][s-o]=e.innerHTML,t+=1)})}))},findHeaderRow:function(){var t=0;e(this.columns,function(e){"string"!=typeof e[0]&&(t=null)}),this.headerRow=0},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},parseTypes:function(){for(var t,e,i,s,n,o=this.columns,a=o.length;a--;)for(t=o[a].length;t--;)e=o[a][t],i=parseFloat(e),s=this.trim(e),s==i?(o[a][t]=i,i>31536e6?o[a].isDatetime=!0:o[a].isNumeric=!0):(n=Date.parse(e),0!==a||"number"!=typeof n||isNaN(n)?o[a][t]=s:(o[a][t]=n,o[a].isDatetime=!0))},parsed:function(){this.options.parsed&&this.options.parsed.call(this,this.columns)},complete:function(){var t,e,i,s,n,o,a,r,h,l=this.columns,m=this.options;if(m.complete){for(l.length>1&&(i=l.shift(),0===this.headerRow&&i.shift(),t=i.isNumeric||i.isDatetime,t||(e=i),i.isDatetime&&(s="datetime")),n=[],r=0;r<l.length;r++){for(0===this.headerRow&&(a=l[r].shift()),o=[],h=0;h<l[r].length;h++)o[h]=void 0!==l[r][h]?t?[i[h],l[r][h]]:l[r][h]:null;n[r]={name:a,data:o}}m.complete({xAxis:{categories:e,type:s},series:n})}}}),t.Data=i,t.data=function(t){return new i(t)}}(Highcharts);